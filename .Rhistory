### Load collection data
coll <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/colldata_allsamples.tsv") %>%
select(SampleID, date, coord_N, coord_W) %>%
rename(Date = date, Latitude = coord_N, Longitude = coord_W)
# Add additional PL17 collection data
pl17 <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/samples_2017.tsv",
col_types = cols(date = col_date(format = "%Y-%d-%m"))) %>%
mutate(date = as.Date(date)) %>%
select(SampleID, date, coord_N, coord_W) %>%
rename(Date = date, Latitude = coord_N, Longitude = coord_W)
comb <- coll %>%
left_join(., pl17, join_by(SampleID)) %>%
mutate(Date = coalesce(Date.x, Date.y),
Latitude = coalesce(Latitude.x, Latitude.y),
Longitude = coalesce(Longitude.x, Longitude.y)) %>%
select(-Date.x, -Date.y, -Latitude.x, -Latitude.y, -Longitude.x, -Longitude.y)
### Join sample list and collection data
temp1 <- left_join(samplesSLOP, comb, join_by(SampleID)) %>%
select(SampleID, Sample, Species, Location, Date, Latitude, Longitude, newly_seq)
### Add existing accession numbers
acc <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/accessions/accessions_all.tsv")
temp2 <- left_join(temp1, acc, by = join_by(SampleID))
### Manually add collection data for "Ross" samples (coordinates for Cayo Arenas)
tempR <- temp2 %>%
mutate(
Date = case_when(
str_detect(SampleID, "Ross") ~ ymd("2017-01-01"),
TRUE ~ Date),
Latitude = case_when(
str_detect(SampleID, "Ross") ~ 22.115278,
TRUE ~ Latitude),
Longitude = case_when(
str_detect(SampleID, "Ross") ~ -91.398333,
TRUE ~ Longitude)
)
### Add collection data and accession numbers for "Betancur" samples
betancur <- read_csv(file = "/Users/martin/Documents/Projects/5_Phylogeny/metadata/betancur_samples.csv") %>%
select(`Tissue No.`, Date, Latitude, Longitude) %>%
rename(SampleID = `Tissue No.`) %>%
mutate(
Accession = case_when(   # Run accessions, not sample accessions
SampleID == "FL0318" ~ "SRR19070349",
SampleID == "FL0331" ~ "SRR18184334",
SampleID == "FL0835" ~ "SRR17839752",
SampleID == "FL0836" ~ "SRR18184176",
SampleID == "FL0839" ~ "SRR19070321",
SampleID == "FL0880" ~ "SRR17839729",
TRUE ~ NA)
)
# Convert geo coordinates to decimal
betancur$Latitude <- gsub("°", " ", betancur$Latitude)
betancur$Longitude <- gsub("°", " ", betancur$Longitude)
betancur$Latitude <- gsub("  ", " ", betancur$Latitude)
betancur$Longitude <- gsub("  ", " ", betancur$Longitude)
betancur$Latitude <- gsub("[N']", "", betancur$Latitude)
betancur$Longitude <- gsub("[W']", "", betancur$Longitude)
betancur$Latitude <- as.numeric(measurements::conv_unit(betancur$Latitude, from = "deg_dec_min", to = "dec_deg"))
betancur$Longitude <- as.numeric(measurements::conv_unit(betancur$Longitude, from = "deg_dec_min", to = "dec_deg"))
# Convert to date format
betancur$Date <- as.Date(betancur$Date,  format = "%m/%d/%y")
# Join
tempRB <- tempR %>%
left_join(., betancur, join_by(SampleID)) %>%
mutate(Date = coalesce(Date.x, Date.y),
Latitude = coalesce(Latitude.x, Latitude.y),
Longitude = coalesce(Longitude.x, Longitude.y),
Accession = coalesce(Accession.x, Accession.y)) %>%
select(-Date.x, -Date.y, -Latitude.x, -Latitude.y, -Longitude.x, -Longitude.y, -Accession.x, -Accession.y)
### Finalize
final <- tempRB %>%
mutate(
Species = case_when(
Species == "abe" ~ "H. aberrans",
Species == "aff" ~ "H. affinis",
Species == "atl" ~ "H. atlahua",
Species == "cas" ~ "H. castroaguirrei",
Species == "chl" ~ "H. chlorurus",
Species == "eco" ~ "H. ecosur",
Species == "esp" ~ "H. sp2",
Species == "flo" ~ "H. floridae",
Species == "gem" ~ "H. gemma",
Species == "gum" ~ "H. gummigutta",
Species == "gut" ~ "H. guttavarius",
Species == "ind" ~ "H. indigo",
Species == "lib" ~ "H. liberte",
Species == "may" ~ "H. maya",
Species == "nig" ~ "H. nigricans",
Species == "pro" ~ "H. providencianus",
Species == "pue" ~ "H. puella",
Species == "ran" ~ "H. randallorum",
Species == "tan" ~ "H. sp1",
Species == "uni" ~ "H. unicolor",
Species == "tab" ~ "S. tabacarius",
Species == "tig" ~ "S. tigrinus",
Species == "tor" ~ "S. tortugarum",
TRUE ~ NA),
Location = case_when(
Location == "ala" ~ "Arr. Alacranes, Mexico",
Location == "arc" ~ "Cayo Arcas, Mexico",
Location == "are" ~ "Cayo Arenas, Mexico",
Location == "bar" ~ "Barbados",
Location == "bel" ~ "Belize",
Location == "boc" ~ "Bocas del Toro, Panama",
Location == "flk" ~ "Florida Keys, USA",
Location == "gun" ~ "Guna Yala, Panama",
Location == "hai" ~ "Haiti",
Location == "hon" ~ "Honduras",
Location == "liz" ~ "Anton Lizardo, Mexico",
Location == "pri" ~ "Puerto Rico",
Location == "qui" ~ "Quintana, Mexico",
Location == "san" ~ "San Andres, Colombia",
Location == "tam" ~ "Tamiahua, Mexico",
TRUE ~ NA),
Accession = case_when(
# SampleID == "28393" ~ NA,
# SampleID == "PL17_111" ~ NA,
# SampleID == "18449" ~ "ERS2619710",
# SampleID == "18986" ~ "ERS8632037",
TRUE ~ Accession)
) %>%
select(SampleID, Species, Location, Date, Latitude, Longitude, Accession, newly_seq)
### Samples to submit
(to_submit <- final %>%
filter(is.na(Accession)))
# ... of which have been sequenced a while ago:
to_submit %>% filter(newly_seq == "no")
### Samples to submit
(to_submit <- final %>%
filter(is.na(Accession)))
# ... of which have been sequenced a while ago:
to_submit %>% filter(newly_seq == "no")
# ... of which were sequenced again
final %>% filter(newly_seq == "yes" & Accession != "NA")
# ... of which were sequenced again
final %>% filter(newly_seq == "yes" & Accession != "NA")
### Samples to submit
(to_submit <- final %>%
filter(is.na(Accession)))
### Add existing accession numbers
acc <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/accessions/accessions_all.tsv")
temp2 <- left_join(temp1, acc, by = join_by(SampleID))
View(temp2)
setwd("~/Documents/Projects/1_Resources/0_Metadata/accessions")
dev.off()
rm(list=ls())
### Read in accession numbers
acc_hench <- read_tsv("accessions_hench19.tsv") %>%
select(SampleID, Accession)
acc_moran <- read_tsv("accessions_moran19.tsv") %>%
select(SampleID, Accession)
acc_pnas <- read_tsv("accessions_pnas.tsv") %>%
select(SampleID, Accession)
acc_coul <- read_tsv("accessions_Coulmance22_TableS1.tsv") %>%
rename(SampleID = ID, Accession = `Accesion Number`) %>%
select(SampleID, Accession)
acc_puebla <- read_tsv("accessions_Puebla22_Appendix7.tsv") %>%
rename(SampleID = `STRI #`, Accession = `ENA Acc. #`) %>%
select(SampleID, Accession)
acc <- rbind(acc_hench, acc_moran, acc_pnas, acc_coul, acc_puebla)
acc
### Join
acc <- rbind(acc_hench, acc_moran, acc_pnas, acc_coul, acc_puebla) %>%
arrange(SampleID) %>%
group_by(SampleID) %>%
filter(!(is.na(Accession) & n() > 1)) %>%
ungroup()
acc
print(acc, n = nrow(acc))
### Write complete list to file
write_tsv(acc, file = "accessions_all.tsv")
setwd("~/Documents/Projects/5_Phylogeny/hamlet_phylogeny")
### Read in sample list
samples <- read_tsv(file = "metadata/samples_ids.txt", col_names = "Sample")
### Add species / location information
samplesSL <- samples %>%
mutate(SampleID = str_sub(Sample, end = -7),
Species = str_sub(Sample, -6, -4),
Location = str_sub(Sample, -3, -1)
)
### Add old sample labels (prior to relabeling)
samplesSLO <- samplesSL %>%
mutate(Old = case_when(
Sample == "54761nigliz" ~ "54761atlliz",
Sample == "52989nigtam" ~ "52989atltam",
Sample == "27936flotam" ~ "27936atltam",
Sample == "PL17_35puepri" ~ "PL17_35indpri",
Sample == "19294tangun" ~ "19294affgun",
Sample == "62585uniarc" ~ "62585esparc",
Sample == "62571uniarc" ~ "62571esparc",
Sample == "62555uniarc" ~ "62555esparc",
Sample == "27698gutqui" ~ "27698abequi",
TRUE ~ Sample
))
### Mark newly sequenced samples
newly_seq <- read_lines("metadata/newly_seq_ids.txt")
samplesSLOP <- samplesSLO %>%
mutate(newly_seq = case_when(SampleID %in% newly_seq ~ "yes",
TRUE ~ "no"))
### Load collection data
coll <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/colldata_allsamples.tsv") %>%
select(SampleID, date, coord_N, coord_W) %>%
rename(Date = date, Latitude = coord_N, Longitude = coord_W)
# Add additional PL17 collection data
pl17 <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/samples_2017.tsv",
col_types = cols(date = col_date(format = "%Y-%d-%m"))) %>%
mutate(date = as.Date(date)) %>%
select(SampleID, date, coord_N, coord_W) %>%
rename(Date = date, Latitude = coord_N, Longitude = coord_W)
comb <- coll %>%
left_join(., pl17, join_by(SampleID)) %>%
mutate(Date = coalesce(Date.x, Date.y),
Latitude = coalesce(Latitude.x, Latitude.y),
Longitude = coalesce(Longitude.x, Longitude.y)) %>%
select(-Date.x, -Date.y, -Latitude.x, -Latitude.y, -Longitude.x, -Longitude.y)
### Join sample list and collection data
temp1 <- left_join(samplesSLOP, comb, join_by(SampleID)) %>%
select(SampleID, Sample, Species, Location, Date, Latitude, Longitude, newly_seq)
### Add existing accession numbers
acc <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/accessions/accessions_all.tsv")
temp2 <- left_join(temp1, acc, by = join_by(SampleID))
### Manually add collection data for "Ross" samples (coordinates for Cayo Arenas)
tempR <- temp2 %>%
mutate(
Date = case_when(
str_detect(SampleID, "Ross") ~ ymd("2017-01-01"),
TRUE ~ Date),
Latitude = case_when(
str_detect(SampleID, "Ross") ~ 22.115278,
TRUE ~ Latitude),
Longitude = case_when(
str_detect(SampleID, "Ross") ~ -91.398333,
TRUE ~ Longitude)
)
### Add collection data and accession numbers for "Betancur" samples
betancur <- read_csv(file = "/Users/martin/Documents/Projects/5_Phylogeny/metadata/betancur_samples.csv") %>%
select(`Tissue No.`, Date, Latitude, Longitude) %>%
rename(SampleID = `Tissue No.`) %>%
mutate(
Accession = case_when(   # Run accessions, not sample accessions
SampleID == "FL0318" ~ "SRR19070349",
SampleID == "FL0331" ~ "SRR18184334",
SampleID == "FL0835" ~ "SRR17839752",
SampleID == "FL0836" ~ "SRR18184176",
SampleID == "FL0839" ~ "SRR19070321",
SampleID == "FL0880" ~ "SRR17839729",
TRUE ~ NA)
)
# Convert geo coordinates to decimal
betancur$Latitude <- gsub("°", " ", betancur$Latitude)
betancur$Longitude <- gsub("°", " ", betancur$Longitude)
betancur$Latitude <- gsub("  ", " ", betancur$Latitude)
betancur$Longitude <- gsub("  ", " ", betancur$Longitude)
betancur$Latitude <- gsub("[N']", "", betancur$Latitude)
betancur$Longitude <- gsub("[W']", "", betancur$Longitude)
betancur$Latitude <- as.numeric(measurements::conv_unit(betancur$Latitude, from = "deg_dec_min", to = "dec_deg"))
betancur$Longitude <- as.numeric(measurements::conv_unit(betancur$Longitude, from = "deg_dec_min", to = "dec_deg"))
# Convert to date format
betancur$Date <- as.Date(betancur$Date,  format = "%m/%d/%y")
# Join
tempRB <- tempR %>%
left_join(., betancur, join_by(SampleID)) %>%
mutate(Date = coalesce(Date.x, Date.y),
Latitude = coalesce(Latitude.x, Latitude.y),
Longitude = coalesce(Longitude.x, Longitude.y),
Accession = coalesce(Accession.x, Accession.y)) %>%
select(-Date.x, -Date.y, -Latitude.x, -Latitude.y, -Longitude.x, -Longitude.y, -Accession.x, -Accession.y)
### Finalize
final <- tempRB %>%
mutate(
Species = case_when(
Species == "abe" ~ "H. aberrans",
Species == "aff" ~ "H. affinis",
Species == "atl" ~ "H. atlahua",
Species == "cas" ~ "H. castroaguirrei",
Species == "chl" ~ "H. chlorurus",
Species == "eco" ~ "H. ecosur",
Species == "esp" ~ "H. sp2",
Species == "flo" ~ "H. floridae",
Species == "gem" ~ "H. gemma",
Species == "gum" ~ "H. gummigutta",
Species == "gut" ~ "H. guttavarius",
Species == "ind" ~ "H. indigo",
Species == "lib" ~ "H. liberte",
Species == "may" ~ "H. maya",
Species == "nig" ~ "H. nigricans",
Species == "pro" ~ "H. providencianus",
Species == "pue" ~ "H. puella",
Species == "ran" ~ "H. randallorum",
Species == "tan" ~ "H. sp1",
Species == "uni" ~ "H. unicolor",
Species == "tab" ~ "S. tabacarius",
Species == "tig" ~ "S. tigrinus",
Species == "tor" ~ "S. tortugarum",
TRUE ~ NA),
Location = case_when(
Location == "ala" ~ "Arr. Alacranes, Mexico",
Location == "arc" ~ "Cayo Arcas, Mexico",
Location == "are" ~ "Cayo Arenas, Mexico",
Location == "bar" ~ "Barbados",
Location == "bel" ~ "Belize",
Location == "boc" ~ "Bocas del Toro, Panama",
Location == "flk" ~ "Florida Keys, USA",
Location == "gun" ~ "Guna Yala, Panama",
Location == "hai" ~ "Haiti",
Location == "hon" ~ "Honduras",
Location == "liz" ~ "Anton Lizardo, Mexico",
Location == "pri" ~ "Puerto Rico",
Location == "qui" ~ "Quintana, Mexico",
Location == "san" ~ "San Andres, Colombia",
Location == "tam" ~ "Tamiahua, Mexico",
TRUE ~ NA),
Accession = case_when(
# SampleID == "28393" ~ NA,
# SampleID == "PL17_111" ~ NA,
SampleID == "18449" ~ "ERS2619710",
# SampleID == "18986" ~ "ERS8632037",
TRUE ~ Accession)
) %>%
select(SampleID, Species, Location, Date, Latitude, Longitude, Accession, newly_seq)
### Samples to submit
(to_submit <- final %>%
filter(is.na(Accession)))
# ... of which have been sequenced a while ago:
to_submit %>% filter(newly_seq == "no")
# ... of which were sequenced again
final %>% filter(newly_seq == "yes" & Accession != "NA")
### Missing collection data
(no_meta <- final %>%
filter(is.na(Date) | is.na(Latitude) | is.na(Longitude)))
(no_date <- final %>%
filter(is.na(Date) & !is.na(Latitude) & !is.na(Longitude)))
(no_gps <- final %>%
filter(!is.na(Date) & is.na(Latitude) & is.na(Longitude)))
print(no_meta, n = nrow(no_meta))
### Write to file
final$Latitude <- sprintf("%.5f", final$Latitude)
final$Longitude <- sprintf("%.5f", final$Longitude)
write_tsv(final %>% select(-newly_seq),
file = "metadata/samples_table.tsv", col_names = TRUE)
(pri <- final %>% filter(Location == "Puerto Rico"))
View(pri)
(fl0 <- final %>% filter(str_detect(SampleID, "FL0"))
)
View(final)
pri
view(pri)
rm(list = ls())
### Read in sample list
samples <- read_tsv(file = "metadata/samples_ids.txt", col_names = "Sample")
### Add species / location information
samplesSL <- samples %>%
mutate(SampleID = str_sub(Sample, end = -7),
Species = str_sub(Sample, -6, -4),
Location = str_sub(Sample, -3, -1)
)
### Add old sample labels (prior to relabeling)
samplesSLO <- samplesSL %>%
mutate(Old = case_when(
Sample == "54761nigliz" ~ "54761atlliz",
Sample == "52989nigtam" ~ "52989atltam",
Sample == "27936flotam" ~ "27936atltam",
Sample == "PL17_35puepri" ~ "PL17_35indpri",
Sample == "19294tangun" ~ "19294affgun",
Sample == "62585uniarc" ~ "62585esparc",
Sample == "62571uniarc" ~ "62571esparc",
Sample == "62555uniarc" ~ "62555esparc",
Sample == "27698gutqui" ~ "27698abequi",
TRUE ~ Sample
))
### Mark newly sequenced samples
newly_seq <- read_lines("metadata/newly_seq_ids.txt")
samplesSLOP <- samplesSLO %>%
mutate(newly_seq = case_when(SampleID %in% newly_seq ~ "yes",
TRUE ~ "no"))
### Load collection data
coll <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/colldata_allsamples.tsv") %>%
select(SampleID, date, coord_N, coord_W) %>%
rename(Date = date, Latitude = coord_N, Longitude = coord_W)
# Add additional PL17 collection data
pl17 <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/samples_2017.tsv",
col_types = cols(date = col_date(format = "%Y-%d-%m"))) %>%
mutate(date = as.Date(date)) %>%
select(SampleID, date, coord_N, coord_W) %>%
rename(Date = date, Latitude = coord_N, Longitude = coord_W)
# Add Gulf collection data
gulf <- read_tsv(file = "/Users/martin/Documents/Projects/5_Phylogeny/sampeles/Collaborators/Hypoplectrus-Base.tsv")
# Add Gulf collection data
gulf <- read_tsv(file = "/Users/martin/Documents/Projects/5_Phylogeny/samples/Collaborators/Hypoplectrus-Base.tsv")
spec(gulf)
comb <- coll %>%
left_join(., pl17, join_by(SampleID)) %>%
mutate(Date = coalesce(Date.x, Date.y),
Latitude = coalesce(Latitude.x, Latitude.y),
Longitude = coalesce(Longitude.x, Longitude.y)) %>%
select(-Date.x, -Date.y, -Latitude.x, -Latitude.y, -Longitude.x, -Longitude.y)
### Join sample list and collection data
temp1 <- left_join(samplesSLOP, comb, join_by(SampleID)) %>%
select(SampleID, Sample, Species, Location, Date, Latitude, Longitude, newly_seq)
### Add existing accession numbers
acc <- read_tsv(file = "/Users/martin/Documents/Projects/1_Resources/0_Metadata/accessions/accessions_all.tsv")
temp2 <- left_join(temp1, acc, by = join_by(SampleID))
### Manually add collection data for "Ross" samples (coordinates for Cayo Arenas)
tempR <- temp2 %>%
mutate(
Date = case_when(
str_detect(SampleID, "Ross") ~ ymd("2017-01-01"),
TRUE ~ Date),
Latitude = case_when(
str_detect(SampleID, "Ross") ~ 22.115278,
TRUE ~ Latitude),
Longitude = case_when(
str_detect(SampleID, "Ross") ~ -91.398333,
TRUE ~ Longitude)
)
### Add collection data and accession numbers for "Betancur" samples
betancur <- read_csv(file = "/Users/martin/Documents/Projects/5_Phylogeny/metadata/betancur_samples.csv") %>%
select(`Tissue No.`, Date, Latitude, Longitude) %>%
rename(SampleID = `Tissue No.`) %>%
mutate(
Accession = case_when(   # Run accessions, not sample accessions
SampleID == "FL0318" ~ "SRR19070349",
SampleID == "FL0331" ~ "SRR18184334",
SampleID == "FL0835" ~ "SRR17839752",
SampleID == "FL0836" ~ "SRR18184176",
SampleID == "FL0839" ~ "SRR19070321",
SampleID == "FL0880" ~ "SRR17839729",
TRUE ~ NA)
)
# Convert geo coordinates to decimal
betancur$Latitude <- gsub("°", " ", betancur$Latitude)
betancur$Longitude <- gsub("°", " ", betancur$Longitude)
betancur$Latitude <- gsub("  ", " ", betancur$Latitude)
betancur$Longitude <- gsub("  ", " ", betancur$Longitude)
betancur$Latitude <- gsub("[N']", "", betancur$Latitude)
betancur$Longitude <- gsub("[W']", "", betancur$Longitude)
betancur$Latitude <- as.numeric(measurements::conv_unit(betancur$Latitude, from = "deg_dec_min", to = "dec_deg"))
betancur$Longitude <- as.numeric(measurements::conv_unit(betancur$Longitude, from = "deg_dec_min", to = "dec_deg"))
# Convert to date format
betancur$Date <- as.Date(betancur$Date,  format = "%m/%d/%y")
# Join
tempRB <- tempR %>%
left_join(., betancur, join_by(SampleID)) %>%
mutate(Date = coalesce(Date.x, Date.y),
Latitude = coalesce(Latitude.x, Latitude.y),
Longitude = coalesce(Longitude.x, Longitude.y),
Accession = coalesce(Accession.x, Accession.y)) %>%
select(-Date.x, -Date.y, -Latitude.x, -Latitude.y, -Longitude.x, -Longitude.y, -Accession.x, -Accession.y)
### Finalize
final <- tempRB %>%
mutate(
Species = case_when(
Species == "abe" ~ "H. aberrans",
Species == "aff" ~ "H. affinis",
Species == "atl" ~ "H. atlahua",
Species == "cas" ~ "H. castroaguirrei",
Species == "chl" ~ "H. chlorurus",
Species == "eco" ~ "H. ecosur",
Species == "esp" ~ "H. sp2",
Species == "flo" ~ "H. floridae",
Species == "gem" ~ "H. gemma",
Species == "gum" ~ "H. gummigutta",
Species == "gut" ~ "H. guttavarius",
Species == "ind" ~ "H. indigo",
Species == "lib" ~ "H. liberte",
Species == "may" ~ "H. maya",
Species == "nig" ~ "H. nigricans",
Species == "pro" ~ "H. providencianus",
Species == "pue" ~ "H. puella",
Species == "ran" ~ "H. randallorum",
Species == "tan" ~ "H. sp1",
Species == "uni" ~ "H. unicolor",
Species == "tab" ~ "S. tabacarius",
Species == "tig" ~ "S. tigrinus",
Species == "tor" ~ "S. tortugarum",
TRUE ~ NA),
Location = case_when(
Location == "ala" ~ "Arr. Alacranes, Mexico",
Location == "arc" ~ "Cayo Arcas, Mexico",
Location == "are" ~ "Cayo Arenas, Mexico",
Location == "bar" ~ "Barbados",
Location == "bel" ~ "Belize",
Location == "boc" ~ "Bocas del Toro, Panama",
Location == "flk" ~ "Florida Keys, USA",
Location == "gun" ~ "Guna Yala, Panama",
Location == "hai" ~ "Haiti",
Location == "hon" ~ "Honduras",
Location == "liz" ~ "Anton Lizardo, Mexico",
Location == "pri" ~ "Puerto Rico",
Location == "qui" ~ "Quintana, Mexico",
Location == "san" ~ "San Andres, Colombia",
Location == "tam" ~ "Tamiahua, Mexico",
TRUE ~ NA),
Accession = case_when(
# SampleID == "28393" ~ NA,
# SampleID == "PL17_111" ~ NA,
SampleID == "18449" ~ "ERS2619710",
# SampleID == "18986" ~ "ERS8632037",
TRUE ~ Accession)
) %>%
select(SampleID, Species, Location, Date, Latitude, Longitude, Accession, newly_seq)
### Samples to submit
(to_submit <- final %>%
filter(is.na(Accession)))
# ... of which have been sequenced a while ago:
to_submit %>% filter(newly_seq == "no")
# ... of which were sequenced again
final %>% filter(newly_seq == "yes" & Accession != "NA")
### Missing collection data
(no_meta <- final %>%
filter(is.na(Date) | is.na(Latitude) | is.na(Longitude)))
view((no_meta <- final %>%
filter(is.na(Date) | is.na(Latitude) | is.na(Longitude))))
